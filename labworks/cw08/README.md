# Лабораторная работа 8. Массивы данных

## Цель работы

Научиться создавать и использовать двумерные массивы динамическй длины на языке C/C++.

## Выделение и освобождение памяти

Из предыдущей работы стало ясно, что все наши переменные хранятся в памяти.

До этого момента во всех программах мы заранее (ещё до запуска) знали, сколько переменных нам нужно.
Однако зачастую их количество неизвестно до какого-либо времени.
Например, пока пользователь не указал размер матрицы для подсчёта её дискриминанта, нет смысла выделять под её хранение память.

В языке C/C++ есть функции, которые позволяют зарезервировать столько памяти под наши переменные, сколько необходимо.

Одной из таких функций является `void* malloc( std::size_t size );`.

Пример создания переменной типа int:

```cpp
int *i_ptr = (int *) malloc(sizeof(int)); // нашли длину типа int (4 байта) и выделили память такого объёма
*i_ptr = 5; // можем работать с этой переменной, но только с * в начале
```

Чтобы освободить память после того, как переменная нам стала не нужна, существует функция `free`.
Пример использования:

```cpp
free(i_ptr); // всё, ранее выделенная память под число больше не нужна
```

Обязательно необходимо освобождать зарезервированную память, т.к. однажды оперативная память на компьютере может закончиться.

## Создание массива неизвестной длины

> Пример на языке C. На C++ код будет отличаться только операторами ввода/вывода.

Массив - это пронумерованный набор однородных данных.
Например, массив чисел или символов.

Нумерация элементов массива в C-подобных языках всегда идёт с 0.
Это связано с тем, что номер элемента в массиве - это смещение адреса памяти относительно начала массива.
Поэтому элемент 0 - это начало массива, элемент 1 - это смещение на 1 элемент далее по памяти, 2 - на 2 элемента и т.д.

Пример создания массива, заполнения его случайными числами и вывод значений элементов на экран:

```cpp
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main()
{
    srand(time(NULL)); // чтобы случайные числа были более случайными
    
    int n; // длина будущего массива
    int *x; // тут будет наш будуший массив
    
    scanf("%d", &n); // сколько элементов будет массив?
    
    // создание массива
    x = (int *) malloc(sizeof(int) * n); // длина элемента массива - sizeof(int), элеменов n
    
    // заполнение массива
    for (int i = 0; i < n; i++) {
        x[i] = rand() % 100 - 50; // случайное число от -50 до 49
    }
    
    // вывод массива
    for (int i = 0; i < n; i++) {
        printf("%4d ", x[i]);
    }

    // освобождение памяти
    free(x);

    return 0;
}
```

> Число 4 в выражении `%4d` обозначает ширину числа в символах. Это необходимо для более красивого вывода массива на экран.

## Алгоритм создания динамического двумерного массива

Двумерный массив можно воспринимать как одномерный массив одномерных массивов.

Другими словами, это массив строк, где каждый элемент - это массив значений в этой строке.
Например, если мы хотим объявить двумерный массив чисел (другими словами, двумерную матрицу), мы должны объявить массив строк этой матрицы и для каждой строки объявить массив чисел в этой строке.

Таким образом, алгоритм следующий:

* у пользователя запрашивается количество строк (пусть n) и столбцов (пусть m)
* резервируется массив укателей на элементы (числа, символы, дроби и т.д.), равный количеству строк (для целого числа - `sizeof(int*) * n`)
* в цикле для каждой строки резервируется память под массив элементов в строке (для целого числа - `sizeof(int) * m`)

![картинка для понимания](https://prog-cpp.ru/wp-content/uploads/2014/03/massiv5.png)

Алгоритм заполнения массива похож на рисование пирамидок в л/р №3 - используется цикл в цикле.

## Задание

1. Воспроизвести у себя программу по резервированию одномерного массива.
2. Реализовать аналог этой программы для двумерного массива.


## Ссылки

* [Лабораторная работа №7](../cw07/README.md)
